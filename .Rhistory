coordinates(pHV_subsoilpH)<- ~ X + Y
plot(hunterCovariates_sub[[1]], main="orginal data"); plot(pHV_subsoilpH, add=T)
# tangled data
tPP<- as.data.frame(tangles.out[[1]])
coordinates(tPP)<- ~ X + Y
plot(tangler.out[[1]], main="tangled data");plot(tPP, add=T)
plot(hunterCovariates_sub[[1]], main="orginal data"); plot(pHV_subsoilpH, add=T)
plot(tangler.out[[1]], main="tangled data");plot(tPP, add=T)
# Plotting
par(mfrow=c(1,2))
# original data
pHV_subsoilpH<- HV_subsoilpH
coordinates(pHV_subsoilpH)<- ~ X + Y
plot(hunterCovariates_sub[[1]], main="orginal data"); plot(pHV_subsoilpH, add=T)
# tangled data
tPP<- as.data.frame(tangles.out[[1]])
coordinates(tPP)<- ~ X + Y
plot(tangler.out[[1]], main="tangled data");plot(tPP, add=T)
# Plotting
par(mfrow=c(1,2))
# original data
pHV_subsoilpH<- HV_subsoilpH
coordinates(pHV_subsoilpH)<- ~ X + Y
plot(hunterCovariates_sub[[1]], main="orginal data"); plot(pHV_subsoilpH, add=T)
# tangled data
tPP<- as.data.frame(tangles.out[[1]])
coordinates(tPP)<- ~ X + Y
plot(tangler.out[[1]], main="tangled data");plot(tPP, add=T)
devtools::build_vignettes()
devtools::build_vignettes()
library(devtools)
devtools::build_vignettes()
devtools::build_vignettes()
devtools::build_vignettes()
devtools::build_vignettes()
devtools::build_vignettes()
devtools::build_vignettes()
library(tangles)
load("Z:/Dropbox/2019/rmuddles/deIDent/data/detangler_data.rda")
load("Z:/Dropbox/2019/rmuddles/deIDent/data/detangler_data.rda")
load("Z:/Dropbox/2019/rmuddles/deIDent/data/detanglerData.rda")
load("Z:/Dropbox/2019/rmuddles/deIDent/data/detangler_data.rda")
getwd()
setwd("Z:/Dropbox/2019/rmuddles/deIDent/data/")
save(detangler_data, file="detangler_data.rda", compress='xz')
load("Z:/Dropbox/2019/rmuddles/deIDent/data/hunterCovariates_sub.rda")
save(hunterCovariates_sub, file="hunterCovariates_sub.rda", compress='xz')
load("Z:/Dropbox/2019/rmuddles/deIDent/data/HV_subsoilpH.rda")
save(HV_subsoilpH, file="HV_subsoilpH.rda", compress='xz')
library(tangles)
devtools::build_vignettes()
devtools::build_vignettes()
library(tangles)
library(tangles)
devtools::build_vignettes()
library(tangles)
library(tangles)
library(tangles)
path=NULL
# write revised coordinates to file
nm2<- paste0(path, "/tangledXY_raster", hash.out, ".rds")
source('C:/rdev/tangles/R/tangles.R')
source('C:/rdev/tangles/R/tangler.R')
source('C:/rdev/tangles/R/detangles.R')
library(digest);library(raster);library(sp)
# DATA SETS
# POINT PATTERN
data("HV_subsoilpH")
# RASTER OBJECT
data("hunterCovariates_sub")
getwd()
setwd<- "C:/Temp/"
xyData<- as.matrix(HV_subsoilpH[,1:2])
# DATA SETS
# POINT PATTERN
data("HV_subsoilpH")
# R libraries
library(tangles);library(digest);library(raster);library(sp)
# DATA SETS
# POINT PATTERN
data("HV_subsoilpH")
# RASTER OBJECT
data("hunterCovariates_sub")
source('C:/rdev/tangles/R/tangles.R')
source('C:/rdev/tangles/R/tangler.R')
source('C:/rdev/tangles/R/detangles.R')
xyData<- as.matrix(HV_subsoilpH[,1:2])
tangles.out<- tangles(data = xyData, depth = 3, rasterdata = FALSE, raster_object = FALSE, saveTangles = TRUE, path = getwd())
str(tangles.out)
getwd()
setwd<- "C:/Temp/"
getwd()
xyData<- as.matrix(HV_subsoilpH[,1:2])
xyData<- as.matrix(HV_subsoilpH[,1:2])
tangles.out<- tangles(data = xyData, depth = 3, rasterdata = FALSE, raster_object = FALSE, saveTangles = TRUE, path = "C:/Temp/")
str(tangles.out)
# First entangle the point pattern
xyData<- as.matrix(HV_subsoilpH[,1:2])
tangles.out<- tangles(data = xyData, depth = 5, rasterdata = TRUE, raster_object = FALSE, saveTangles = TRUE, path = "C:/Temp/")
# Now entangle the raster object
tangler.out<- tangler(data = hunterCovariates_sub, tanglerInfo = tangles.out[[2]], raster_object = TRUE, stub = "myname", saveTangles = TRUE, path = "C:/Temp/")
# Plotting
par(mfrow=c(1,2))
# original data
pHV_subsoilpH<- HV_subsoilpH
coordinates(pHV_subsoilpH)<- ~ X + Y
plot(hunterCovariates_sub[[1]], main="orginal data"); plot(pHV_subsoilpH, add=T)
# tangled data
tPP<- as.data.frame(tangles.out[[1]])
coordinates(tPP)<- ~ X + Y
plot(tangler.out[[1]], main="tangled data");plot(tPP, add=T)
plot(hunterCovariates_sub[[1]], main="orginal data"); plot(pHV_subsoilpH, add=T)
library(tangles)
library(tangles)
library(devtools)
build_vignettes()
install.packages("digest")
install.packages("digest")
remove.packages("digest")
install.packages("digest")
build_vignettes()
library(devtools)
build_vignettes()
library(tangles)
rmarkdown::render(
input      = "vignettes/deidentification.Rmd",
output_dir = "inst/doc/",                    # folder you want it in
output_file= "deidentification.html"              # optional—defaults to your_doc.html
)
rmarkdown::render(
input      = "vignettes/deidentification.Rmd",
output_dir = "inst/doc/",                    # folder you want it in
output_file= "deidentification.html"              # optional—defaults to your_doc.html
)
packages <- tools::CRAN_package_db()
length(packages$Package)
data(detangler_data)
summary(detangler_data)
detangler_data
tempdir()
rmarkdown::render(
input      = "vignettes/deidentification.Rmd",
output_dir = "inst/doc/",                    # folder you want it in
output_file= "deidentification.html"              # optional—defaults to your_doc.html
)
rmarkdown::render(
input      = "vignettes/deidentification.Rmd",
output_dir = "inst/doc/",                    # folder you want it in
output_file= "deidentification.html"              # optional—defaults to your_doc.html
)
library(hexSticker)
install.packages("hexSticker")
library(hexSticker)
library(ggplot2)
# Example ggplot to act as background/logo
p <- ggplot(data.frame(x = c(0, 1)), aes(x)) +
stat_function(fun = function(x) exp(-((x - 0.5)^2) / 0.01), color = "blue", size = 1.2) +  # bell
stat_function(fun = function(x) 1 / (1 + exp(-10 * (x - 0.5))), color = "green", size = 1.2) +  # sigmoid
stat_function(fun = function(x) pmax(0, 1 - abs(x - 0.5) * 2), color = "purple", size = 1.2) +  # triangle
theme_void()
# Create the hex sticker
sticker(p,
package = "maptility",
p_size = 20,
p_color = "white",
p_family = "sans",
s_x = 1,
s_y = 0.8,
s_width = 1.4,
s_height = 1.4,
h_fill = "#325c48",  # background
h_color = "#FFFFFF",  # border
url = "github.com/brendo1001/maptility",
u_size = 4,
u_color = "white",
filename = "maptility_sticker.png")
getwd()
library(hexSticker)
# Create the hex sticker using your custom image
sticker(
image = "/home/brendo1001/Downloads/maptility_clean_raster_logo.png",  # path to the image
package = "maptility",                # package name
p_size = 20,                          # font size
p_color = "white",                    # font color
p_family = "sans",
s_x = 1, s_y = 0.8,                   # image position
s_width = 1.4, s_height = 1.4,        # image size
h_fill = "#2f4f2f",                   # background fill (DarkGreen-like)
h_color = "#ffffff",                 # border color
url = "github.com/brendo1001/maptility", # optional URL at bottom
u_size = 4,
u_color = "white",
filename = "maptility_sticker.png"   # output file name
)
# Create the hex sticker using your custom image
sticker(
image = "/home/brendo1001/Downloads/maptility_clean_raster_logo.png",
subplot = F,# path to the image
package = "maptility",                # package name
p_size = 20,                          # font size
p_color = "white",                    # font color
p_family = "sans",
s_x = 1, s_y = 0.8,                   # image position
s_width = 1.4, s_height = 1.4,        # image size
h_fill = "#2f4f2f",                   # background fill (DarkGreen-like)
h_color = "#ffffff",                 # border color
url = "github.com/brendo1001/maptility", # optional URL at bottom
u_size = 4,
u_color = "white",
filename = "maptility_sticker.png"   # output file name
)
# Create the hex sticker using your custom image
sticker(
image = "/home/brendo1001/Downloads/maptility_clean_raster_logo.png",
subplot = F,# path to the image
package = "maptility",                # package name
p_size = 20,                          # font size
p_color = "white",                    # font color
p_family = "sans",
s_x = 1, s_y = 0.8,                   # image position
s_width = 1.4, s_height = 1.4,        # image size
h_fill = "#2f4f2f",                   # background fill (DarkGreen-like)
h_color = "#ffffff",                 # border color
url = "github.com/brendo1001/maptility", # optional URL at bottom
u_size = 4,
u_color = "white",
filename = "maptility_sticker.png"   # output file name
library(hexSticker)
# Create the hex sticker using your custom image
sticker(
image = "/home/brendo1001/Downloads/maptility_clean_raster_logo.png",
subplot = F,# path to the image
package = "maptility",                # package name
p_size = 20,                          # font size
p_color = "white",                    # font color
p_family = "sans",
s_x = 1, s_y = 0.8,                   # image position
s_width = 1.4, s_height = 1.4,        # image size
h_fill = "#2f4f2f",                   # background fill (DarkGreen-like)
h_color = "#ffffff",                 # border color
url = "github.com/brendo1001/maptility", # optional URL at bottom
u_size = 4,
u_color = "white",
filename = "maptility_sticker.png"   # output file name
library(hexSticker)
# Create the hex sticker using your custom image
sticker(
image = "/home/brendo1001/Downloads/maptility_clean_raster_logo.png",
subplot = F,# path to the image
package = "maptility",                # package name
p_size = 20,                          # font size
p_color = "white",                    # font color
p_family = "sans",
s_x = 1, s_y = 0.8,                   # image position
s_width = 1.4, s_height = 1.4,        # image size
h_fill = "#2f4f2f",                   # background fill (DarkGreen-like)
h_color = "#ffffff",                 # border color
url = "github.com/brendo1001/maptility", # optional URL at bottom
u_size = 4,
u_color = "white",
filename = "maptility_sticker.png"   # output file name
library(hexSticker)
# Create the hex sticker using your custom image
sticker(
image = "/home/brendo1001/Downloads/maptility_clean_raster_logo.png",
subplot = F,# path to the image
package = "maptility",                # package name
p_size = 20,                          # font size
p_color = "white",                    # font color
p_family = "sans",
s_x = 1, s_y = 0.8,                   # image position
s_width = 1.4, s_height = 1.4,        # image size
h_fill = "#2f4f2f",                   # background fill (DarkGreen-like)
h_color = "#ffffff",                 # border color
url = "github.com/brendo1001/maptility", # optional URL at bottom
u_size = 4,
u_color = "white",
filename = "maptility_sticker.png"   # output file name
library(hexSticker)
library(hexSticker)
library(magick)
library(grid)
# Read your PNG as a rasterGrob object
img_path <- "/home/brendo1001/Downloads/maptility_clean_raster_logo.png"
img <- image_read(img_path)
grob_img <- rasterGrob(as.raster(img), interpolate = TRUE)
# Now create the sticker using `subplot = grob_img`
sticker(
subplot = grob_img,
package = "maptility",
p_size = 20,
p_color = "white",
p_family = "sans",
s_x = 1, s_y = 0.8,
s_width = 1.4, s_height = 1.4,
h_fill = "#2f4f2f",
h_color = "#ffffff",
url = "github.com/brendo1001/maptility",
u_size = 4,
u_color = "white",
filename = "maptility_sticker.png"
)
# Save original state
old_opts    <- options()
old_par     <- par(no.readonly = TRUE)
old_wd      <- getwd()
orig_search <- search()
# On exit, restore state and detach any new packages
on.exit({
options(old_opts)
par(old_par)
setwd(old_wd)
new_pkgs <- setdiff(search(), orig_search)
for (pkg in new_pkgs) {
if (grepl("^package:", pkg)) {
detach(pkg, character.only = TRUE, unload = TRUE)
}
}
}, add = TRUE)
# Load required libraries
library(tangles)
# Load required libraries
library(tangles)
library(digest)
library(terra)
library(sf)
# Load point data
data("HV_subsoilpH")
# Load raster data from files
ext_path <- system.file("extdata", package = "tangles")
rast.files <- list.files(path = ext_path, full.names = TRUE)
rasters <- terra::rast(rast.files)
xyData <- as.matrix(HV_subsoilpH[, 1:2])
tangles.out <- tangles(
data = xyData,
depth = 3,
rasterdata = FALSE,
raster_object = FALSE,
saveTangles = TRUE,
exportShapefile = TRUE,
path = tempdir()
)
# Using sf input
df <- HV_subsoilpH[, 1:2]
sf_pts <- st_as_sf(df, coords = c("X", "Y"))
tangles.sf.out <- tangles(
data = sf_pts,
depth = 3,
saveTangles = TRUE,
exportShapefile = TRUE,
path = tempdir()
)
tangles.ras.out <- tangles(
data = rasters,
depth = 3,
rasterdata = TRUE,
raster_object = TRUE,
saveTangles = TRUE,
path = tempdir()
)
# 1. Tangling the point data
xyData <- as.matrix(HV_subsoilpH[, 1:2])
tangles.out <- tangles(
data = xyData,
depth = 4,
rasterdata = TRUE,
raster_object = FALSE,
saveTangles = FALSE
)
# 2. Tangling the raster data using the same detangler
tangler.out <- tangler(
data = rasters,
tanglerInfo = tangles.out[[2]],
raster_object = TRUE,
stub = "combined",
saveTangles = FALSE
)
# 3. Convert points to sf objects
original_pts <- st_as_sf(HV_subsoilpH, coords = c("X", "Y"))
tangled_pts <- st_as_sf(as.data.frame(tangles.out[[1]]), coords = c("X", "Y"))
# 4. Plot both
par(mfrow = c(1, 2))
plot(rasters[[1]], main = "Original Raster + Points")
plot(original_pts, add = TRUE, pch = 16, col = "blue")
plot(tangler.out[[1]][[1]], main = "Tangled Raster + Points")
plot(tangled_pts, add = TRUE, pch = 16, col = "red")
terra::plot(rasters[[1]], main = "Original Raster + Points")
plot(sf::st_geometry(original_pts), add = TRUE, pch = 16, col = "blue")
sf::st_geometry(original_pts)
terra::plot(rasters[[1]], main = "Original Raster + Points")
plot(sf::st_geometry(original_pts), add = TRUE, pch = 16, col = "blue")
terra::plot(rasters[[1]], main = "Original Raster + Points")
terra::points(terra::vect(original_pts), pch = 16, col = "blue")
terra::vect(original_pts)
# 4. Plot both
par(mfrow = c(1, 2))
terra::plot(rasters[[1]], main = "Original Raster + Points")
terra::points(terra::vect(original_pts), pch = 16, col = "blue")
terra::plot(r, main = "Original Raster + Points", reset = FALSE)
rasters[[1]]
terra::plot(rasters[[1]], main = "Original Raster + Points", reset = FALSE)
plot(sf::st_geometry(original_pts), add = TRUE, pch = 16, col = "blue")
# Save original state
old_opts    <- options()
old_par     <- par(no.readonly = TRUE)
old_wd      <- getwd()
orig_search <- search()
# On exit, restore state and detach any new packages
on.exit({
options(old_opts)
par(old_par)
setwd(old_wd)
new_pkgs <- setdiff(search(), orig_search)
for (pkg in new_pkgs) {
if (grepl("^package:", pkg)) {
detach(pkg, character.only = TRUE, unload = TRUE)
}
}
}, add = TRUE)
# Load required libraries
library(tangles)
library(digest)
library(terra)
library(sf)
# Load point data
data("HV_subsoilpH")
# Load raster data from files
ext_path <- system.file("extdata", package = "tangles")
rast.files <- list.files(path = ext_path, full.names = TRUE)
rasters <- terra::rast(rast.files)
xyData <- as.matrix(HV_subsoilpH[, 1:2])
tangles.out <- tangles(
data = xyData,
depth = 3,
rasterdata = FALSE,
raster_object = FALSE,
saveTangles = TRUE,
exportShapefile = TRUE,
path = tempdir()
)
# Using sf input
df <- HV_subsoilpH[, 1:2]
sf_pts <- st_as_sf(df, coords = c("X", "Y"))
tangles.sf.out <- tangles(
data = sf_pts,
depth = 3,
saveTangles = TRUE,
exportShapefile = TRUE,
path = tempdir()
)
tangles.ras.out <- tangles(
data = rasters,
depth = 3,
rasterdata = TRUE,
raster_object = TRUE,
saveTangles = TRUE,
path = tempdir()
)
# 1. Tangling the point data
xyData <- as.matrix(HV_subsoilpH[, 1:2])
tangles.out <- tangles(
data = xyData,
depth = 4,
rasterdata = TRUE,
raster_object = FALSE,
saveTangles = FALSE
)
# 2. Tangling the raster data using the same detangler
tangler.out <- tangler(
data = rasters,
tanglerInfo = tangles.out[[2]],
raster_object = TRUE,
stub = "combined",
saveTangles = FALSE
)
# 3. Convert points to sf objects
original_pts <- st_as_sf(HV_subsoilpH, coords = c("X", "Y"))
tangled_pts <- st_as_sf(as.data.frame(tangles.out[[1]]), coords = c("X", "Y"))
# 4. Plot both
par(mfrow = c(1, 2))
plot(rasters[[1]], main = "Original Raster + Points")
# 4. Plot both
par(mfrow = c(1, 2))
plot(rasters[[1]], main = "Original Raster + Points")
plot(original_pts, add = TRUE, pch = 16, col = "blue")
r <- rasters[[1]]                 # SpatRaster
p <- original_pts                 # sf
terra::plot(r, main = "Original Raster + Points", reset = FALSE)
plot(sf::st_geometry(p), add = TRUE, pch = 16, col = "blue")
plot(sf::st_geometry(p), add = TRUE, pch = 16, col = "red")
r <- rasters[[1]]                 # SpatRaster
p <- original_pts                 # sf
terra::plot(r, main = "Original Raster + Points", reset = FALSE)
plot(sf::st_geometry(p), add = TRUE, pch = 16, col = "red")
r <- rasters[[1]]                 # SpatRaster
p <- original_pts                 # sf
terra::plot(r, main = "Original Raster + Points", reset = FALSE)
plot(sf::st_geometry(p), add = TRUE, pch = 16, col = "red")
par(mfrow = c(1, 2))
r <- rasters[[1]]
p <- original_pts
terra::plot(r, main = "Original Raster + Points", reset = FALSE)
plot(sf::st_geometry(p), add = TRUE, pch = 16, col = "red")
r <- tangler.out[[1]][[1]]
p <- tangled_pts
terra::plot(r, main = "Tangled Raster + Points", reset = FALSE)
plot(sf::st_geometry(p), add = TRUE, pch = 16, col = "red")
rmarkdown::render(
input      = "vignettes/deidentification.Rmd",
output_dir = "inst/doc/",                    # folder you want it in
output_file= "deidentification.html"              # optional—defaults to your_doc.html
)
